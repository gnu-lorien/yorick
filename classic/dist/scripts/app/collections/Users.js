define(["jquery","underscore","parse","backbone"],function(e,t,a,r){var n=a.Collection.extend({model:a.User,initialize:function(){var e=this;e.query=new a.Query(e.model)},comparator:function(e,a){var r,n,d=this;return t.has(d,"sortbycreated")?(r=a.createdAt,n=e.createdAt):(r=e.get("paidOn"),n=a.get("paidOn")),t.gt(r,n)?1:t.lt(r,n)?-1:0},fetch:function(e){var r=this,e=e||{};t.defaults(e,{add:!0,update:!0,select:["id","username","realname","email"]});var n=new a.Query(r.model);if(e.update&&0!=r.models.length){var d=t.map(r.models,"createdAt");d=t.sortBy(d),n.greaterThan("createdAt",t.last(d))}n.select.apply(n,e.select);var c=[];return n.each(function(e){c.push(e)}).then(function(){return e.add?t.each(c,function(e){r.add(e)}):r.reset(c),a.Promise.as(r)})}});return n});