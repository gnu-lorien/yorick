define(["jquery","underscore","parse","backbone","marionette","../collections/Users"],function(e,r,n,t,s,u){var a=t.Model.extend({initialize:function(){var e=this;e.channel=t.Wreqr.radio.channel("user"),e.users=new u,t.Wreqr.radio.reqres.setHandler("user","get",function(r){return e.users.get(r)}),t.Wreqr.radio.reqres.setHandler("user","all",function(){var r=n.User.current().get("storytellerinterface"),t=n.User.current().get("admininterface");if(t||r)return e.users;var s=new u;return s.models.push(e.users.get(n.User.current().id)),s})},get_users:function(){var e=this,n=n||{};return r.defaults(n,{update:!0}),e.users.fetch()},get_latest_patronage:function(e){var r,t=new n.Query("Patronage").equalTo("owner",e).descending("expiresOn");return t.first().then(function(e){r=e}).always(function(){return n.Promise.as(r)})}});return new a});