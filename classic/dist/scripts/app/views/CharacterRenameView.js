define(["jquery","backbone","marionette","backform"],function(e,t,s,n){var a=s.ItemView.extend({tagName:"form",template:_.template(""),initialize:function(){var s=this;this.form=new n.Form({el:this.$el,model:new t.Model,fields:[{name:"name",label:"Character Name",control:"input"},{name:"submit",label:"Update",control:"button",disabled:!0,id:"submit"}],events:{change:function(e){e.preventDefault(),this.$("button[name=submit]").removeAttr("disabled");var t=this.fields.get("submit");t.get("status");"success"!=t.get("status")&&t.has("status")||(t.set({status:"",message:"",disabled:!1}),this.$el.enhanceWithin())},submit:function(t){var n=this;return t.preventDefault(),e.mobile.loading("show"),n.undelegateEvents(),n.model.errorModel.clear(),s.character.set("name",n.model.get("name")),s.character.save().then(function(){n.fields.get("submit").set({status:"success",message:"Successfully Updated",disabled:!0}),n.$el.enhanceWithin()},function(e){n.fields.get("submit").set({status:"error",message:_.escape(e.message),disabled:!1}),n.$el.enhanceWithin()}).always(function(){e.mobile.loading("hide"),n.delegateEvents()}),!1}}})},onRender:function(){return this.form.render(),this.$el.enhanceWithin(),this},register:function(e){return this.character=e,this.form.model.set("name",e.get("name")),this.render()}});return a});