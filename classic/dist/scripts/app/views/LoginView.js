define(["jquery","backbone","parse","hello","../helpers/PromiseFailReport","../helpers/InjectAuthData","../helpers/FacebookLogin"],function(e,o,t,n,i,r,l){var a=o.View.extend({events:{"submit form.login-form":"logIn","click #login-with-facebook":"logInWithFacebook"},el:"#login",initialize:function(){_.bindAll(this,"logIn"),this.render()},logInWithFacebook:function(o){var n=this;o.preventDefault(),n.undelegateEvents(),n.$(".login-form .error").hide(),this.$(".login-form button").attr("disabled","disabled"),l().then(function(){e.mobile.changePage(window.location.hash,{allowSamePageTransition:!0,changeHash:!1}),t.history.loadUrl()},function(e){console.log(JSON.stringify(e)),"undefined"!=typeof trackJs&&trackJs.console.error("Error in promise",JSON.stringify(e)),n.$(".login-form .error").html(_.escape(e.message)).show(),n.$(".login-form button").removeAttr("disabled"),n.delegateEvents()})},logIn:function(e){var o=this;o.$(".login-form .error").hide();var n=this.$("#login-username").val(),i=this.$("#login-password").val();return e.preventDefault(),o.undelegateEvents(),t.User.logIn(n,i,{success:function(e){location.reload()},error:function(e,t){o.$(".login-form .error").html(_.escape(t.message)).show(),o.$(".login-form button").removeAttr("disabled"),o.delegateEvents()}}),!1},render:function(){this.template=_.template(e("#login-template").html())(),this.$el.find("div[role='main']").html(this.template),this.$el.enhanceWithin(),this.delegateEvents()}});return a});